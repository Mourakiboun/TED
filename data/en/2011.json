[
   {
        "_id": "14",
        "lang": "en", "learn":" Learn more",
        "title": "2011 Tunisian Elections Summary",
        "subtitle": "2011 Tunisian Elections Summary",
        "excerpt":"Tunisia’s Oct. 23 2011 elections chose the members of the National Constituent Assembly, the body tasked with drafting Tunisia’s new con¬stitution and forming its transitional government. These elections were the result of a popu¬lar revolution through which Tunisians overthrew the existing authori¬tarian regime and sought to democratically elect a new government. ",
        "description": "",
        "about_data": "",
        "methodology": "",
        "picture": "img/projects/intro.png", 
        "map": ""
    },
    {
        "_id": "1",
        "lang": "en", "learn":" Learn more",
        "title": "Exploring Ennahdha Results in the 2011 Elections",
        "subtitle": "Political party and coalition support",
    	"excerpt":"This visualization highlights the density of electoral district-level support for Ennahdha in the 2011 National Constituent Assembly elections.  Ennahdha won 89 seats and received the highest percentage of votes in 26 of 27 electoral districts in Tunisia; in Sidi Bouzid, Ennahdha finished with the second highest percentage of votes behind Popular Petition (Aridha).  Ennahdha also received the highest percentage of votes in all six out-of-country (OCV) voting districts.",
        "description": "This visualization highlights the density of electoral district-level support for Ennahdha in the 2011 National Constituent Assembly elections.  Ennahdha won 89 seats and received the highest percentage of votes in 26 of 27 electoral districts in Tunisia; in Sidi Bouzid, Ennahdha finished with the second highest percentage of votes behind Popular Petition (Aridha).  Ennahdha also received the highest percentage of votes in all six out-of-country (OCV) voting districts.",
        "about_data": "Tabular data for Ennahdha election results from the 2011 National Constituent Assembly elections. <br/>https://github.com/fwelections/tunisia-election-data/blob/master/2011data/resultsPerParty/Nahdha.csv",
        "methodology": "eligibility map for detailed instructions ",
        "picture": "img/projects/nahdha.png", 
        "map": "tunisia.map-u3z7fdnm,mehdi118218.hif2hb1j"
    },
    {
        "_id": "2",
        "lang": "en", "learn":" Learn more",
        "title": "Exploring Al Aridha Results in the 2011 Elections",
        "subtitle": "Political party and coalition support",
        "excerpt": "This visualization highlights the district-level results of Al Aridha (Popular Petition) during the 2011 NCA elections. The political movement ranked first in Sidi Bouzid, the only district where Ennahdha came in second. Initially, Al Aridha won 27 seats: 26 seats inside the country and one for Tunisians abroad. But prior to the announcement of the preliminary results, the ISIE nullified eight seats in six constituencies for breaching campaign finance regulations...",
        "description": "This visualization highlights the district-level results of Al Aridha (Popular Petition) during the 2011 NCA elections. The political movement ranked first in Sidi Bouzid, the only district where Ennahdha came in second. Initially, Al Aridha won 27 seats: 26 seats inside the country and one for Tunisians abroad. But prior to the announcement of the preliminary results, the ISIE nullified eight seats in six constituencies for breaching campaign finance regulations. The Administrative Court overruled the ISIE’s decision, granting Al Aridha seven of the nullified seats for a total of 26 seats - the third highest proportion of seats in the NCA.",
        "about_data": "this map relies on two datasets <br/>- [Tabular data for the four parties and coalitions that, in addition to Enaritha (89 seats) won 20 or more seats in the 2011 elections.](https://github.com/fwelections/tunisia-election-data/tree/master/2011data/resultsPerParty)</br>- geometry for the 27 governorates we will derive from the [delegation shapefiles](https://github.com/fwelections/tunisia-election-data/tree/master/shapes). ",
        "methodology": "<h4>1. Dissolving Delegations into Districts<h4><p>Since the party data has a district-level resolution, we need to create district polygons out of [delegation polygons that we already imported](https://github.com/fwelections/tunisia-election-data/tree/master/shapes).To do this you'll need to load the `filter_rings()` function explained in [this post](http://www.spatialdbadvisor.com/postgis_tips_tricks/92/filtering-rings-in-polygon-postgis). This  functions removes artifacts left by unioning each district's member delegations. Once you've loaded [the function](https://gist.github.com/ian29/5091516) into your database, run the following query</p> <pre>create table districts as (<br/>select<br/>circo_id,<br/>filter_rings(st_union(the_geom),2) as the_geom<br/>from delegations<br/>group by circo_id<br/>);<br/></pre><h4>2. Importing party data to PostGIS</h4><p>If you have not already, you will need to import the delegation shapefiles. Detailed information for importing shapefiles can be found in the [Data management + mapping section of Setup.md](!SITE.GITHUB!/blob/gh-pages/setup.md#data-processing-for-making-maps).</p><p>To import the tabular data, first set up 4 tables - one for each party (Aritha, CPR, and Takattoul, Joumhouri). Run the following sql in the `psql` shell.</p><pre>create table takattoul (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,<br/>total_votes_ratio numeric<br/>);<br/>create table Aritha (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,total_votes_ratio numeric);<br/>create table cpr (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,<br/>total_votes_ratio numeric<br/>);<br/>create table Joumhouri (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,<br/>total_votes_ratio numeric<br/>);</pre><p>To populate the tables you just set up, run these commands from your command shell. They are labeled for your reference.</p><pre><br/># Aritha<br/>cat 2011data/resultsPerParty/Aritha.csv | psql -d tunisia c \"COPY Aritha FROM STDIN WITH DELIMITER ';' CSV HEADER\"<br/># takattoul <br/>cat 2011data/resultsPerParty/takattoul.csv | psql -d tunisia -c \"COPY takattoul FROM STDIN WITH DELIMITER ';' CSV HEADER\" <br/># CPR <br/>cat 2011data/resultsPerParty/cpr.csv | psql -d tunisia -c \"COPY cpr FROM STDIN WITH DELIMITER ';' CSV HEADER\" <br/></pre><h4>3. Joining all  parties' tables</h4><p>In order to see data for all three parties associated in one table, we will need to join two parties' tables together for joining the third. Thankfully the `district_id` key is consistent across tables. To join, run </p><pre><br/>select<br/>b.ratio_t,<br/>b.ratio_c,<br/>n.total_votes_ratio as ratio_n,<br/>n.district_id,<br/>n.district<br/>from cpr n join <br/>( select <br/>t.total_votes_ratio as ratio_t,<br/>c.total_votes_ratio as ratio_c,<br/>c.district_id<br/>from takattoul t join cpr c<br/>on t.district_id = c.district_id<br/>) as b<br/>on n.district_id = b.district_id;<br/></pre> <p>n addition to joining the relevant columns into one table, this query aliases the `total_votes_ratio` column from each table as `ratio_x` where `x` is the first letter of each party's (and table's) name. It will be important to remember the naming conventions implemented now, as they will have implications at various steps downstream.</p><h4>4. Joining spatial data to tabular data</h4><p>To join the tabular data compiled in the previous to the district polygons we created earlier, run the following SQL:</p><pre><br/>create table parties as (<br/>select<br/>g.circo_id,<br/>g.the_geom,<br/>d.district_id,<br/>d.district,<br/>d.ratio_t,<br/>d.ratio_n,<br/>d.ratio_c,<br/>coalesce(cast(round(d.ratio_t) as text)||'%', 'n/a') as ratio_tc,<br/>coalesce(cast(round(d.ratio_n) as text)||'%', 'n/a') as ratio_nc,<br/>coalesce(cast(round(d.ratio_c) as text)||'%', 'n/a') as ratio_cc<br/>from districts g left join <br/>( select<br/>b.ratio_t,<br/>b.ratio_c,<br/>n.total_votes_ratio as ratio_n,<br/>n.district_id,<br/>n.district<br/>from aritha n join<br/>( select  <br/>t.total_votes_ratio as ratio_t,<br/>c.total_votes_ratio as ratio_c,<br/>c.district_id<br/>from takattoul t join cpr c<br/>on t.district_id = c.district_id<br/>) as b<br/>on n.district_id = b.district_id<br/>) as d<br/>on circo_id = d.district_id<br/>);<br/></pre><p>You are now ready to style your data.</p>",
        "picture": "img/projects/aridaa.png", 
        "map": "tunisia.map-u3z7fdnm,mehdi118218.hg8ja8pm"
    },
    {
        "_id": "3",
        "lang": "en", "learn":" Learn more",
        "title": "Exploring Ettakatol Results in the 2011 Elections",
        "subtitle": "Political party and coalition support",
        "excerpt": "This visualization highlights the district-level results of Ettakatol, also known as the Democratic Forum for Labor and Liberties, in the 2011 NCA elections. Ettakatol received most of its votes in the greater Tunis districts (Tunis 1, Tunis 2, Ariana, Ben Arous); Ettakatol came in second after Ennahdha in these four constituencies. The votes Ettakatol received in these four constituencies represent almost half of Ettakatol’s total votes (128,099 out of 285,530). Overall, Ettakatol ranked fourth in the NCA with a total of 20 seats (9%)...",
        "description": "This visualization highlights the district-level results of Ettakatol, also known as the Democratic Forum for Labor and Liberties, in the 2011 NCA elections. Ettakatol received most of its votes in the greater Tunis districts (Tunis 1, Tunis 2, Ariana, Ben Arous); Ettakatol came in second after Ennahdha in these four constituencies. The votes Ettakatol received in these four constituencies represent almost half of Ettakatol’s total votes (128,099 out of 285,530). Overall, Ettakatol ranked fourth in the NCA with a total of 20 seats (9%). The founder and secretary-general of Ettakatol, Mustapha Ben Jaafar, was elected president of the Constituent Assembly in November 22, 2011 with 145 out of 213 votes in the Assembly.",
        "about_data": "this map relies on two datasets <br/>- [Tabular data for the four parties and coalitions that, in addition to Enaritha (89 seats) won 20 or more seats in the 2011 elections.](https://github.com/fwelections/tunisia-election-data/tree/master/2011data/resultsPerParty)</br>- geometry for the 27 governorates we will derive from the [delegation shapefiles](https://github.com/fwelections/tunisia-election-data/tree/master/shapes). ",
        "methodology": "<h4>1. Dissolving Delegations into Districts<h4><p>Since the party data has a district-level resolution, we need to create district polygons out of [delegation polygons that we already imported](https://github.com/fwelections/tunisia-election-data/tree/master/shapes).To do this you'll need to load the `filter_rings()` function explained in [this post](http://www.spatialdbadvisor.com/postgis_tips_tricks/92/filtering-rings-in-polygon-postgis). This  functions removes artifacts left by unioning each district's member delegations. Once you've loaded [the function](https://gist.github.com/ian29/5091516) into your database, run the following query</p> <pre>create table districts as (<br/>select<br/>circo_id,<br/>filter_rings(st_union(the_geom),2) as the_geom<br/>from delegations<br/>group by circo_id<br/>);<br/></pre><h4>2. Importing party data to PostGIS</h4><p>If you have not already, you will need to import the delegation shapefiles. Detailed information for importing shapefiles can be found in the [Data management + mapping section of Setup.md](!SITE.GITHUB!/blob/gh-pages/setup.md#data-processing-for-making-maps).</p><p>To import the tabular data, first set up 4 tables - one for each party (Aritha, CPR, and Takattoul, Joumhouri). Run the following sql in the `psql` shell.</p><pre>create table takattoul (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,<br/>total_votes_ratio numeric<br/>);<br/>create table Aritha (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,total_votes_ratio numeric);<br/>create table cpr (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,<br/>total_votes_ratio numeric<br/>);<br/>create table Joumhouri (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,<br/>total_votes_ratio numeric<br/>);</pre><p>To populate the tables you just set up, run these commands from your command shell. They are labeled for your reference.</p><pre><br/># Aritha<br/>cat 2011data/resultsPerParty/Aritha.csv | psql -d tunisia c \"COPY Aritha FROM STDIN WITH DELIMITER ';' CSV HEADER\"<br/># takattoul <br/>cat 2011data/resultsPerParty/takattoul.csv | psql -d tunisia -c \"COPY takattoul FROM STDIN WITH DELIMITER ';' CSV HEADER\" <br/># CPR <br/>cat 2011data/resultsPerParty/cpr.csv | psql -d tunisia -c \"COPY cpr FROM STDIN WITH DELIMITER ';' CSV HEADER\" <br/></pre><h4>3. Joining all  parties' tables</h4><p>In order to see data for all three parties associated in one table, we will need to join two parties' tables together for joining the third. Thankfully the `district_id` key is consistent across tables. To join, run </p><pre><br/>select<br/>b.ratio_t,<br/>b.ratio_c,<br/>n.total_votes_ratio as ratio_n,<br/>n.district_id,<br/>n.district<br/>from cpr n join <br/>( select <br/>t.total_votes_ratio as ratio_t,<br/>c.total_votes_ratio as ratio_c,<br/>c.district_id<br/>from takattoul t join cpr c<br/>on t.district_id = c.district_id<br/>) as b<br/>on n.district_id = b.district_id;<br/></pre> <p>n addition to joining the relevant columns into one table, this query aliases the `total_votes_ratio` column from each table as `ratio_x` where `x` is the first letter of each party's (and table's) name. It will be important to remember the naming conventions implemented now, as they will have implications at various steps downstream.</p><h4>4. Joining spatial data to tabular data</h4><p>To join the tabular data compiled in the previous to the district polygons we created earlier, run the following SQL:</p><pre><br/>create table parties as (<br/>select<br/>g.circo_id,<br/>g.the_geom,<br/>d.district_id,<br/>d.district,<br/>d.ratio_t,<br/>d.ratio_n,<br/>d.ratio_c,<br/>coalesce(cast(round(d.ratio_t) as text)||'%', 'n/a') as ratio_tc,<br/>coalesce(cast(round(d.ratio_n) as text)||'%', 'n/a') as ratio_nc,<br/>coalesce(cast(round(d.ratio_c) as text)||'%', 'n/a') as ratio_cc<br/>from districts g left join <br/>( select<br/>b.ratio_t,<br/>b.ratio_c,<br/>n.total_votes_ratio as ratio_n,<br/>n.district_id,<br/>n.district<br/>from aritha n join<br/>( select  <br/>t.total_votes_ratio as ratio_t,<br/>c.total_votes_ratio as ratio_c,<br/>c.district_id<br/>from takattoul t join cpr c<br/>on t.district_id = c.district_id<br/>) as b<br/>on n.district_id = b.district_id<br/>) as d<br/>on circo_id = d.district_id<br/>);<br/></pre><p>You are now ready to style your data.</p>",
        "picture": "img/projects/ETTAKATOL.png", 
        "map": "tunisia.map-u3z7fdnm,mehdi118218.hg8n0gmb"
    },
    {
        "_id": "4",
        "lang": "en", "learn":" Learn more",
        "title": "Exploring CPR Results in the 2011 Elections",
        "subtitle": "Political party and coalition support",
        "excerpt": "This map highlights the degree of support for CPR (Congress for the Republic) at different constituencies during the NCA 2011 elections. Beating the Popular Petition (Aridha) with 3 seats, CPR ranked second in number of seats at the NCA with 29 seats after Ennahdha. CPR got the highest percentage of votes in Kébili with 26.71 % followed by Nabeul and Sfax with 14.19% and 13.02 %. The lowest percentage was recorded in Sidi Bouzid. The results seem to be in favor of CPR in regions dominated by Ennahdha rather than those dominated by El Aridha....",
        "description": "This map highlights the degree of support for CPR (Congress for the Republic) at different constituencies during the NCA 2011 elections. Beating the Popular Petition (Aridha) with 3 seats, CPR ranked second in number of seats at the NCA with 29 seats after Ennahdha. CPR got the highest percentage of votes in Kébili with 26.71 % followed by Nabeul and Sfax with 14.19% and 13.02 %. The lowest percentage was recorded in Sidi Bouzid. The results seem to be in favor of CPR in regions dominated by Ennahdha rather than those dominated by El Aridha.",
        "about_data": "this map relies on two datasets <br/>- [Tabular data for the four parties and coalitions that, in addition to Enaritha (89 seats) won 20 or more seats in the 2011 elections.](https://github.com/fwelections/tunisia-election-data/tree/master/2011data/resultsPerParty)</br>- geometry for the 27 governorates we will derive from the [delegation shapefiles](https://github.com/fwelections/tunisia-election-data/tree/master/shapes). ",
        "methodology": "<h4>1. Dissolving Delegations into Districts<h4><p>Since the party data has a district-level resolution, we need to create district polygons out of [delegation polygons that we already imported](https://github.com/fwelections/tunisia-election-data/tree/master/shapes).To do this you'll need to load the `filter_rings()` function explained in [this post](http://www.spatialdbadvisor.com/postgis_tips_tricks/92/filtering-rings-in-polygon-postgis). This  functions removes artifacts left by unioning each district's member delegations. Once you've loaded [the function](https://gist.github.com/ian29/5091516) into your database, run the following query</p> <pre>create table districts as (<br/>select<br/>circo_id,<br/>filter_rings(st_union(the_geom),2) as the_geom<br/>from delegations<br/>group by circo_id<br/>);<br/></pre><h4>2. Importing party data to PostGIS</h4><p>If you have not already, you will need to import the delegation shapefiles. Detailed information for importing shapefiles can be found in the [Data management + mapping section of Setup.md](!SITE.GITHUB!/blob/gh-pages/setup.md#data-processing-for-making-maps).</p><p>To import the tabular data, first set up 4 tables - one for each party (Aritha, CPR, and Takattoul, Joumhouri). Run the following sql in the `psql` shell.</p><pre>create table takattoul (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,<br/>total_votes_ratio numeric<br/>);<br/>create table Aritha (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,total_votes_ratio numeric);<br/>create table cpr (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,<br/>total_votes_ratio numeric<br/>);<br/>create table Joumhouri (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,<br/>total_votes_ratio numeric<br/>);</pre><p>To populate the tables you just set up, run these commands from your command shell. They are labeled for your reference.</p><pre><br/># Aritha<br/>cat 2011data/resultsPerParty/Aritha.csv | psql -d tunisia c \"COPY Aritha FROM STDIN WITH DELIMITER ';' CSV HEADER\"<br/># takattoul <br/>cat 2011data/resultsPerParty/takattoul.csv | psql -d tunisia -c \"COPY takattoul FROM STDIN WITH DELIMITER ';' CSV HEADER\" <br/># CPR <br/>cat 2011data/resultsPerParty/cpr.csv | psql -d tunisia -c \"COPY cpr FROM STDIN WITH DELIMITER ';' CSV HEADER\" <br/></pre><h4>3. Joining all  parties' tables</h4><p>In order to see data for all three parties associated in one table, we will need to join two parties' tables together for joining the third. Thankfully the `district_id` key is consistent across tables. To join, run </p><pre><br/>select<br/>b.ratio_t,<br/>b.ratio_c,<br/>n.total_votes_ratio as ratio_n,<br/>n.district_id,<br/>n.district<br/>from cpr n join <br/>( select <br/>t.total_votes_ratio as ratio_t,<br/>c.total_votes_ratio as ratio_c,<br/>c.district_id<br/>from takattoul t join cpr c<br/>on t.district_id = c.district_id<br/>) as b<br/>on n.district_id = b.district_id;<br/></pre> <p>n addition to joining the relevant columns into one table, this query aliases the `total_votes_ratio` column from each table as `ratio_x` where `x` is the first letter of each party's (and table's) name. It will be important to remember the naming conventions implemented now, as they will have implications at various steps downstream.</p><h4>4. Joining spatial data to tabular data</h4><p>To join the tabular data compiled in the previous to the district polygons we created earlier, run the following SQL:</p><pre><br/>create table parties as (<br/>select<br/>g.circo_id,<br/>g.the_geom,<br/>d.district_id,<br/>d.district,<br/>d.ratio_t,<br/>d.ratio_n,<br/>d.ratio_c,<br/>coalesce(cast(round(d.ratio_t) as text)||'%', 'n/a') as ratio_tc,<br/>coalesce(cast(round(d.ratio_n) as text)||'%', 'n/a') as ratio_nc,<br/>coalesce(cast(round(d.ratio_c) as text)||'%', 'n/a') as ratio_cc<br/>from districts g left join <br/>( select<br/>b.ratio_t,<br/>b.ratio_c,<br/>n.total_votes_ratio as ratio_n,<br/>n.district_id,<br/>n.district<br/>from aritha n join<br/>( select  <br/>t.total_votes_ratio as ratio_t,<br/>c.total_votes_ratio as ratio_c,<br/>c.district_id<br/>from takattoul t join cpr c<br/>on t.district_id = c.district_id<br/>) as b<br/>on n.district_id = b.district_id<br/>) as d<br/>on circo_id = d.district_id<br/>);<br/></pre><p>You are now ready to style your data.</p>",
        "picture": "img/projects/cpr.png", 
        "map": "tunisia.map-u3z7fdnm,mehdi118218.hg8lnpgk"
    },	
    {
        "_id": "5",
        "lang": "en", "learn":" Learn more",
        "title": "Exploring PDP Results in the 2011 Elections",
        "subtitle": "Political party and coalition support",
        "excerpt": "This map highlights the degree of support for PDP (Progressive Democratic Party) at different constituencies during the NCA 2011 elections. The PDP managed to get 16 seats in the National Constituent Assembly and ranked the fifth largest winning party during the election. This party got its highest score in Beja with 7.58 % of the vote without exceeding the threshold a seat in this constituency as well as in all other constituencies where this party gained representation , its lowest score was recorded in Sidi Bouzid with 1.18 % of the vote without representation for this constituency...",
        "description": "This map highlights the degree of support for PDP (Progressive Democratic Party) at different constituencies during the NCA 2011 elections. The PDP managed to get 16 seats in the National Constituent Assembly and ranked the fifth largest winning party during the election. This party got its highest score in Beja with 7.58 % of the vote without exceeding the threshold a seat in this constituency as well as in all other constituencies where this party gained representation , its lowest score was recorded in Sidi Bouzid with 1.18 % of the vote without representation for this constituency .",
        "about_data": "this map relies on two datasets <br/>- [Tabular data for the four parties and coalitions that, in addition to Enaritha (89 seats) won 20 or more seats in the 2011 elections.](https://github.com/fwelections/tunisia-election-data/tree/master/2011data/resultsPerParty)</br>- geometry for the 27 governorates we will derive from the [delegation shapefiles](https://github.com/fwelections/tunisia-election-data/tree/master/shapes). ",
        "methodology": "<h4>1. Dissolving Delegations into Districts<h4><p>Since the party data has a district-level resolution, we need to create district polygons out of [delegation polygons that we already imported](https://github.com/fwelections/tunisia-election-data/tree/master/shapes).To do this you'll need to load the `filter_rings()` function explained in [this post](http://www.spatialdbadvisor.com/postgis_tips_tricks/92/filtering-rings-in-polygon-postgis). This  functions removes artifacts left by unioning each district's member delegations. Once you've loaded [the function](https://gist.github.com/ian29/5091516) into your database, run the following query</p> <pre>create table districts as (<br/>select<br/>circo_id,<br/>filter_rings(st_union(the_geom),2) as the_geom<br/>from delegations<br/>group by circo_id<br/>);<br/></pre><h4>2. Importing party data to PostGIS</h4><p>If you have not already, you will need to import the delegation shapefiles. Detailed information for importing shapefiles can be found in the [Data management + mapping section of Setup.md](!SITE.GITHUB!/blob/gh-pages/setup.md#data-processing-for-making-maps).</p><p>To import the tabular data, first set up 4 tables - one for each party (Aritha, CPR, and Takattoul, Joumhouri). Run the following sql in the `psql` shell.</p><pre>create table takattoul (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,<br/>total_votes_ratio numeric<br/>);<br/>create table Aritha (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,total_votes_ratio numeric);<br/>create table cpr (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,<br/>total_votes_ratio numeric<br/>);<br/>create table Joumhouri (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,<br/>total_votes_ratio numeric<br/>);</pre><p>To populate the tables you just set up, run these commands from your command shell. They are labeled for your reference.</p><pre><br/># Aritha<br/>cat 2011data/resultsPerParty/Aritha.csv | psql -d tunisia c \"COPY Aritha FROM STDIN WITH DELIMITER ';' CSV HEADER\"<br/># takattoul <br/>cat 2011data/resultsPerParty/takattoul.csv | psql -d tunisia -c \"COPY takattoul FROM STDIN WITH DELIMITER ';' CSV HEADER\" <br/># CPR <br/>cat 2011data/resultsPerParty/cpr.csv | psql -d tunisia -c \"COPY cpr FROM STDIN WITH DELIMITER ';' CSV HEADER\" <br/></pre><h4>3. Joining all  parties' tables</h4><p>In order to see data for all three parties associated in one table, we will need to join two parties' tables together for joining the third. Thankfully the `district_id` key is consistent across tables. To join, run </p><pre><br/>select<br/>b.ratio_t,<br/>b.ratio_c,<br/>n.total_votes_ratio as ratio_n,<br/>n.district_id,<br/>n.district<br/>from cpr n join <br/>( select <br/>t.total_votes_ratio as ratio_t,<br/>c.total_votes_ratio as ratio_c,<br/>c.district_id<br/>from takattoul t join cpr c<br/>on t.district_id = c.district_id<br/>) as b<br/>on n.district_id = b.district_id;<br/></pre> <p>n addition to joining the relevant columns into one table, this query aliases the `total_votes_ratio` column from each table as `ratio_x` where `x` is the first letter of each party's (and table's) name. It will be important to remember the naming conventions implemented now, as they will have implications at various steps downstream.</p><h4>4. Joining spatial data to tabular data</h4><p>To join the tabular data compiled in the previous to the district polygons we created earlier, run the following SQL:</p><pre><br/>create table parties as (<br/>select<br/>g.circo_id,<br/>g.the_geom,<br/>d.district_id,<br/>d.district,<br/>d.ratio_t,<br/>d.ratio_n,<br/>d.ratio_c,<br/>coalesce(cast(round(d.ratio_t) as text)||'%', 'n/a') as ratio_tc,<br/>coalesce(cast(round(d.ratio_n) as text)||'%', 'n/a') as ratio_nc,<br/>coalesce(cast(round(d.ratio_c) as text)||'%', 'n/a') as ratio_cc<br/>from districts g left join <br/>( select<br/>b.ratio_t,<br/>b.ratio_c,<br/>n.total_votes_ratio as ratio_n,<br/>n.district_id,<br/>n.district<br/>from aritha n join<br/>( select  <br/>t.total_votes_ratio as ratio_t,<br/>c.total_votes_ratio as ratio_c,<br/>c.district_id<br/>from takattoul t join cpr c<br/>on t.district_id = c.district_id<br/>) as b<br/>on n.district_id = b.district_id<br/>) as d<br/>on circo_id = d.district_id<br/>);<br/></pre><p>You are now ready to style your data.</p>",
        "picture": "img/projects/PDP.png", 
        "map": "tunisia.map-u3z7fdnm,mehdi118218.hif3mfjj"
    },	
    {
        "_id": "51",
        "lang": "en", "learn":" Learn more",
        "title": "Exploring Afek Tounes Results in the 2011 Elections",
        "subtitle": "Political party and coalition support",
        "excerpt": "This visualization highlights the density of electoral district-level support for Afek Tounes in the 2011 National Constituent Assembly elections. Afek Tounes won 4 seats and received its highest percentage of votes in Mahdia (6,18% of the total votes) where it was represented by RIM MASMOUDI. Afek Tounes was not present in all the electoral districts in the 2011 Tunisian elections....",
        "description": "This visualization highlights the density of electoral district-level support for Afek Tounes in the 2011 National Constituent Assembly elections. Afek Tounes won 4 seats and received its highest percentage of votes in Mahdia (6,18% of the total votes) where it was represented by RIM MASMOUDI. Afek Tounes was not present in all the electoral districts in the 2011 Tunisian elections, however it was represented in 4 of the six out-of- country voting districts.",
        "about_data": "this map relies on two datasets <br/>- [Tabular data for the four parties and coalitions that, in addition to Enaritha (89 seats) won 20 or more seats in the 2011 elections.](https://github.com/fwelections/tunisia-election-data/tree/master/2011data/resultsPerParty)</br>- geometry for the 27 governorates we will derive from the [delegation shapefiles](https://github.com/fwelections/tunisia-election-data/tree/master/shapes). ",
        "methodology": "<h4>1. Dissolving Delegations into Districts<h4><p>Since the party data has a district-level resolution, we need to create district polygons out of [delegation polygons that we already imported](https://github.com/fwelections/tunisia-election-data/tree/master/shapes).To do this you'll need to load the `filter_rings()` function explained in [this post](http://www.spatialdbadvisor.com/postgis_tips_tricks/92/filtering-rings-in-polygon-postgis). This  functions removes artifacts left by unioning each district's member delegations. Once you've loaded [the function](https://gist.github.com/ian29/5091516) into your database, run the following query</p> <pre>create table districts as (<br/>select<br/>circo_id,<br/>filter_rings(st_union(the_geom),2) as the_geom<br/>from delegations<br/>group by circo_id<br/>);<br/></pre><h4>2. Importing party data to PostGIS</h4><p>If you have not already, you will need to import the delegation shapefiles. Detailed information for importing shapefiles can be found in the [Data management + mapping section of Setup.md](!SITE.GITHUB!/blob/gh-pages/setup.md#data-processing-for-making-maps).</p><p>To import the tabular data, first set up 4 tables - one for each party (Aritha, CPR, and Takattoul, Joumhouri). Run the following sql in the `psql` shell.</p><pre>create table takattoul (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,<br/>total_votes_ratio numeric<br/>);<br/>create table Aritha (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,total_votes_ratio numeric);<br/>create table cpr (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,<br/>total_votes_ratio numeric<br/>);<br/>create table Joumhouri (<br/>district_id int,<br/>district text,<br/>active_votes numeric,<br/>active_ratio numeric,<br/>automatic_votes numeric,<br/>automatic_ratio numeric,<br/>total_votes numeric,<br/>total_votes_ratio numeric<br/>);</pre><p>To populate the tables you just set up, run these commands from your command shell. They are labeled for your reference.</p><pre><br/># Aritha<br/>cat 2011data/resultsPerParty/Aritha.csv | psql -d tunisia c \"COPY Aritha FROM STDIN WITH DELIMITER ';' CSV HEADER\"<br/># takattoul <br/>cat 2011data/resultsPerParty/takattoul.csv | psql -d tunisia -c \"COPY takattoul FROM STDIN WITH DELIMITER ';' CSV HEADER\" <br/># CPR <br/>cat 2011data/resultsPerParty/cpr.csv | psql -d tunisia -c \"COPY cpr FROM STDIN WITH DELIMITER ';' CSV HEADER\" <br/></pre><h4>3. Joining all  parties' tables</h4><p>In order to see data for all three parties associated in one table, we will need to join two parties' tables together for joining the third. Thankfully the `district_id` key is consistent across tables. To join, run </p><pre><br/>select<br/>b.ratio_t,<br/>b.ratio_c,<br/>n.total_votes_ratio as ratio_n,<br/>n.district_id,<br/>n.district<br/>from cpr n join <br/>( select <br/>t.total_votes_ratio as ratio_t,<br/>c.total_votes_ratio as ratio_c,<br/>c.district_id<br/>from takattoul t join cpr c<br/>on t.district_id = c.district_id<br/>) as b<br/>on n.district_id = b.district_id;<br/></pre> <p>n addition to joining the relevant columns into one table, this query aliases the `total_votes_ratio` column from each table as `ratio_x` where `x` is the first letter of each party's (and table's) name. It will be important to remember the naming conventions implemented now, as they will have implications at various steps downstream.</p><h4>4. Joining spatial data to tabular data</h4><p>To join the tabular data compiled in the previous to the district polygons we created earlier, run the following SQL:</p><pre><br/>create table parties as (<br/>select<br/>g.circo_id,<br/>g.the_geom,<br/>d.district_id,<br/>d.district,<br/>d.ratio_t,<br/>d.ratio_n,<br/>d.ratio_c,<br/>coalesce(cast(round(d.ratio_t) as text)||'%', 'n/a') as ratio_tc,<br/>coalesce(cast(round(d.ratio_n) as text)||'%', 'n/a') as ratio_nc,<br/>coalesce(cast(round(d.ratio_c) as text)||'%', 'n/a') as ratio_cc<br/>from districts g left join <br/>( select<br/>b.ratio_t,<br/>b.ratio_c,<br/>n.total_votes_ratio as ratio_n,<br/>n.district_id,<br/>n.district<br/>from aritha n join<br/>( select  <br/>t.total_votes_ratio as ratio_t,<br/>c.total_votes_ratio as ratio_c,<br/>c.district_id<br/>from takattoul t join cpr c<br/>on t.district_id = c.district_id<br/>) as b<br/>on n.district_id = b.district_id<br/>) as d<br/>on circo_id = d.district_id<br/>);<br/></pre><p>You are now ready to style your data.</p>",
        "picture": "img/projects/afek.png", 
        "map": "tunisia.map-u3z7fdnm,mehdi118218.i0p235a5"
    },  
    
    { "_id": "6",
    "lang": "en", "learn":" Learn more",
        "title": "Visualizing the level of eligible voter turnout",
        "subtitle": "Voter eligibility and voter registration",
    "excerpt":"According to statistics published by the ISIE on November 12, 2011, 7,993,924 voters were eligible to cast ballots in the 2011 National Constituent Assembly elections. 51% of all eligible voters including actively and passively registered voters cast ballots during the October 23, 2011 NCA elections.This visualization shows eligible voter turnout by district in the 2011 NCA elections.",
        "description": "According to statistics published by the ISIE on November 12, 2011, 7,993,924 voters were eligible to cast ballots in the 2011 National Constituent Assembly elections. 51% of all eligible voters including actively and passively registered voters cast ballots during the October 23, 2011 NCA elections.This visualization shows eligible voter turnout by district in the 2011 NCA elections.",
        "about_data": "Total  voter turnout <br/>https://github.com/fwelections/tunisia-election-data/blob/master/2011data/misc/Turnout.csv <br/> This CSV contains the number of registered voters who cast ballots and the total number of registered voters per electoral district. It was originally obtained from the <a href='http://www.isie.tn/Fr/image.php?id=771'>National Constituent Assembly Report on the Elections (PDF)</a>, published by the <a href='http://www.isie.tn'>Independent High Commission for Elections</a> in February, 2012, and converted to CSV by <a href='https://github.com/fwelections/tunisia-election-data'>OpenGovTN</a>",
        "methodology": "Check the eligibility map ( previous one in order ) for a detailed guide ",
        "picture": "img/projects/turnout.png", 
        "map": "tunisia.map-u3z7fdnm,mehdi118218.hjopl809"
    },
    {   "_id": "7",
    "lang": "en", "learn":" Learn more",
        "title": "Visualizing the proportion of actively registered voters vis-à-vis the eligible voting population",
        "subtitle": "Voter eligibility and voter registration",
    "excerpt":"Identifying delegations with low ratios of actively registered voters compared to eligible voters is a key step for developing more robust voter outreach and registration efforts prior to the next election. ",
        "description": "Identifying delegations with low ratios of actively registered voters compared to eligible voters is a key step for developing more robust voter outreach and registration efforts prior to the next election. This visualization highlights where targeting of resources and efforts by the Independent High Commission for Elections (ISIE), political parties and civil society organizations would have the greatest impact",
        "about_data": "Distribution of registered voters by delegation<br/>https://github.com/fwelections/tunisia-election-data/blob/master/2011data/RegistrationDistributionPerDelegation/RegistDistibutionperDelegation.csv<br/>This CSV contains the number of eligible voters and registered voters per delegation. It was originally obtained from the <a href='http://www.isie.tn/Fr/image.php?id=771'>National Constituent Assembly Report on the Elections (PDF)</a>, published by the <a href='http://www.isie.tn'>Independent High Commission for Elections</a> in February, 2012, and converted to CSV by <a href='https://github.com/fwelections/tunisia-election-data'>OpenGovTN</a>.",
        "methodology": "<p>Tunisia is made up of 24 governorates, which are subdivided into 264 delegations. This map visualizes the disparity between actively registered voters and eligible voters by delegation. Actively registered voters meet the age and citizenship requirements for voting and have registered to vote. Eligible voters meet the requirements to vote, but have not actively registered to vote. </p>Make sure you have read the documentation regarding installing and setting up a PostGIS-enabled database<h4>Importing data to PostGIS</h4><p>This map is comprised of two datasets - delegation shapefiles(https://github.com/fwelections/tunisia-election-data/tree/master/shapes) and tabular eligibility + registration data(https://github.com/fwelections/tunisia-election-data/blob/master/2011data/RegistrationDistributionPerDelegation/RegistDistibutionperDelegation.csv). <p>To import the tabular registration + eligibility data, first set up the table in the tunisia database. Run the following SQL to set up your table. </p><pre><br/>create table regis (<br/>district_id int,<br/>district text,<br/>delegation text, <br/>actively_registred numeric,<br/>eligible_voters numeric,<br/>ratio numeric<br/>);<br/></pre><br/>To populate the table, run the following from your command line (not the command shell)<br/><pre><br/> cat path-to/2011data/RegistrationDistributionPerDelegation/RegistDistibutionperDelegation.csv | psql -d tunisia -c \"COPY regis FROM STDIN WITH DELIMITER ',' CSV HEADER\"<br/></pre><h4>Joining spatial data to tabular data</h4><p>Now that both datasets are in your postgres database, you need join the spatial data (the delegation shapefile) to the tabular data (the RegistDistibutionperDelegation.csv). To do this, run the following SQL</p><br/><pre><br/>create table eligibility as (<br/>select<br/>a.*,<br/>coalesce(cast(b.actively_registred as text), 'n/a') as actively_registred,<br/>coalesce(cast(b.eligible_voters as text), 'n/a') as eligible_voters,<br/>ratio,<br/>coalesce(cast(round(b.ratio) as text)||'%', 'n/a') as ratio_c <br/>from delegations a left join regis b <br/>on replace(replace(lower(cast(circo_id as text)||name_deleg), ' ', ''), '-', '') = replace(replace(replace(lower(cast(district_id <br/>as text)||delegation), ' ', ''), '-', ''), '\r', '')<br/>order by ratio desc<br/>);<br/></pre><p>In addition to performing a `left join` on the geometry to preserve geometry where records from the tabular data do not match, this query reformats the `actively_registered`, `eligible_voters`, and `ratio` columns for cartographic purposes. <br/>- **Round** each value to the nearest integer<br/>- **Cast** values in each column as text in order to concatenate a `%` sign.<br/>- **Coalesce** each value and then the string 'n/a' so that NULL values are still displayed accurately and aesthetically.  <br/>Note that only about 215 of the 270 or so records (rows) match. To get the rest of the records to match, run manual updates changing the names in only one table. </p><br/><pre><br/>update regis set delegation = 'Médina' where delegation = 'Medina';<br/></pre><br/>You're now ready to style your map in TileMill. Create a new project. In TileMill create a PostGIS layer following the online documentation at http://mapbox.com/tilemill/docs/guides/postgis-work/, specifying the `eligibility` table.",
        "picture": "img/projects/eligible.png", 
        "map": "tunisia.map-u3z7fdnm,mehdi118218.hjop7c1p"
    },
    {   "_id": "8",
    "lang": "en", "learn":" Learn more",
        "title": "Highlighting the level of actively registered voter turnout ",
        "subtitle": "Voter registration and voter turnout",
    "excerpt":"An actively registered voter is an eligible voter who confirmed his or her voter registration data at a designated voter registration center.  After an initially low turnout, the ISIE extended the voter registration deadline, increased the number of registration centers, and deployed mobile registration units,to register as many eligible voters as possible prior to the 2011 National Constituent Assembly....",
        "description": "An actively registered voter is an eligible voter who confirmed his or her voter registration data at a designated voter registration center.  After an initially low turnout, the ISIE extended the voter registration deadline, increased the number of registration centers, and deployed mobile registration units,to register as many eligible voters as possible prior to the 2011 National Constituent Assembly elections.According to statistics published by the ISIE on November 12, 2011, 4,123,602 voters – 51% of 7,993,924 eligible voters according to the National ID database - actively registered for the period from early July till late August 2011.  86.4% of actively registered voters cast ballots during the October 23, 2011 NCA elections.  This visualization shows the actively registered voter turnout by district in the 2011 NCA elections",
        "about_data": "Actively passively and total  voter turnout: <br/> https://github.com/fwelections/tunisia-election-data/tree/master/2011data/misc<br/>This CSV contains the number of actively registered voters who cast ballots and the total number of actively registered voters per electoral district. It was originally obtained from the National Constituent Assembly Report on the Elections (PDF), published by the Independent High Commission for Elections in February 2012 and converted to CSV by <a href='https://github.com/fwelections/tunisia-election-data'>OpenGovTN</a>.",
        "methodology": "Check previous maps ( map 1 through 3 ) for detailed guide.", 
        "picture": "img/projects/active.png", 
        "map": "tunisia.map-u3z7fdnm,mehdi118218.hjp13hfg"
    },
    {   "_id": "9",
    "lang": "en", "learn":" Learn more",
        "title": "Highlighting the level of passively registered voter turnout",
        "subtitle": "Voter eligibility and voter turnout",
    "excerpt":"passively registered voter is a citizen enjoying the right to vote in accordance with the provisions of the electoral law of the country, and who is automatically registered in the list of voters, generally on the basis of reliable information available to the local authorities.",
        "description": "passively registered voter is a citizen enjoying the right to vote in accordance with the provisions of the electoral law of the country, and who is automatically registered in the list of voters, generally on the basis of reliable information available to the local authorities. In the 2011 National Constituent Assembly elections, the National ID database was used to identify eligible voters. Eligible voters were encouraged to actively register by confirming their voter registration data at a designated voter registration center.According to statistics published by the ISIE on November 12, 2011, 3,870,322 voters – 49% of  7,993,924 eligible voters according to the National ID database - did not actively register and therefore were considered as passively registered voters.  Only 14% of passively registered voters cast ballots during the October 23, 2011 NCA elections. This visualization shows the passively registered voter turnout by district in the 2011 NCA elections",
        "about_data": "Actively passively and total  voter turnout: <br/> https://github.com/fwelections/tunisia-election-data/tree/master/2011data/misc<br/>This CSV contains the number of actively registered voters who cast ballots and the total number of actively registered voters per electoral district. It was originally obtained from the National Constituent Assembly Report on the Elections (PDF), published by the Independent High Commission for Elections in February 2012 and converted to CSV by <a href='https://github.com/fwelections/tunisia-election-data'>OpenGovTN</a>.",
        "methodology": "<p>Tunisia is made up of 24 governorates, which are subdivided into 264 delegations. This map visualizes the disparity between actively registered voters and eligible voters by delegation. Actively registered voters meet the age and citizenship requirements for voting and have registered to vote. Eligible voters meet the requirements to vote, but have not actively registered to vote. </p><p>Make sure you have read the documentation regarding installing and setting up a PostGIS-enabled database and the previous map guides.",
        "picture": "img/projects/passive.png", 
        "map": "tunisia.map-u3z7fdnm,mehdi118218.hjp1elka"
    },
    {   
    "_id": "10",
    "lang": "en", "learn":" Learn more",
        "title": "Highlighting where local-level coalitions could have the greatest impact",
        "subtitle": "The votes that did not count",
    "excerpt":"In a majority based voting system, there are what we call 'wasted' votes that do not correlate to representation in parliament. These include votes for parties that did not win mandates, votes that were cancelled, and blank ballots submitted as protest votes. This visualization reveals districts represented by parties with weak mandates and thus are vulnerable in the upcoming elections. This enables ....",
        "description": "In a majority based voting system, there are what we call 'wasted' votes that do not correlate to representation in parliament. These include votes for parties that did not win mandates, votes that were cancelled, and blank ballots submitted as protest votes. This visualization reveals districts represented by parties with weak mandates and thus are vulnerable in the upcoming elections. This enables political parties to better understand how to focus their efforts by building coalitions at the local level and develop better strategies for targeting their campaign resources where they are most competitive",
        "about_data": "This dataset includes tables with the number of blank, canceled, wasted, and spoiled votes received by each party, by district. It was converted from <a href='https://github.com/fwelections/tunisia-election-data/tree/master/2011data/misc/source'>PDF</a> to CSV by <a href='https://github.com/fwelections/tunisia-election-data'>FWElections</a>.",
        "methodology": "<p> The votes included for consideration are white ballots (protesting by keeping ballot blank), wasted votes (i.e., vote for a party that did not win mandate), annulled votes, and canceled votes.</p><p>Make sure you have read the documentation regarding installing and setting up a PostGIS-enabled database before proceeding any further.</p><p>Two datasets power this map:</p>- [full 2011 election results]() available as individual `.json` files, parsed and provided as a single district-level CSV. <br/>- geometry for the 27 districts derived from the [delegtion shapefiles](https://github.com/fwelections/tunisia-election-data/tree/master/shapes).<h4>1. Import data to PostGIS</h4>To set up the a table with appropriate columns, run the following SQL:<br/><pre><br/>create table wasted (<br/>cir_id int,<br/>circ_name text,<br/>total_votes numeric,<br/>votes_ennahdha numeric,<br/>votes_cpr numeric,<br/>votes_fdtl numeric,<br/>other_winning numeric,<br/>Wasted numeric,<br/>wasted_ballots numeric,<br/>cancelled_ballots numeric<br/>);<br/></pre><br/>Now run the following from your command line to populate the table: <br/><pre><br/>wasted-votes.csv | psql -d tunisia -c \"COPY wasted FROM STDIN WITH DELIMITER ',' CSV HEADER\"<br/></pre><h4>2. Dissolving Delegations into Districts</h4><p>*Note: If you have already performed this step for the Political parties map, you can skip to step 4.*<br/>Since this data has a district-level resolution, we need to create district polygons out of [delegation polygons that we already imported](https://github.com/fwelections/tunisia-election-data/tree/master/shapes).<br/>To do this you'll need to load the `filter_rings()` function explained in [this post](http://www.spatialdbadvisor.com/postgis_tips_tricks/92/filtering-rings-in-polygon-postgis). This  functions removes artifacts left by unioning each district's member delegations. Once you've loaded [the function](https://gist.github.com/ian29/5091516) into your database, run the following query.<br/><pre><br/>create table districts as (<br/>select<br/>circo_id,<br/>filter_rings(st_union(the_geom),2) as the_geom<br/>from delegations<br/>group by circo_id<br/>);<br/></pre><h4>4. Joining to geometry</h4><p>You should now be able to open the [wasted votes tilemill project](!SITE.GITHUB!/tree/gh-pages/map-src/wasted)<br/>We're joining the tabular data to geometry in TileMill's PostGIS plugin. The query is here for your reference, but you should need to perform any further steps.</p> <br/><pre><br/>( select<br/>the_geom,<br/>cir_id,<br/>circ_name,<br/>wasted_ballots,<br/>cancelled_ballots,<br/>wasted,<br/>map,<br/>total_votes,<br/>round((map / total_votes * 100)) as pct_n,<br/>cast(round((map / total_votes * 100)) as text)||'%' as pct_s,<br/>cast(round((map / total_votes * 100)) as text)||'%'||E' \n'||circ_name as display<br/>from districts a join wasted b <br/>on circo_id = cir_id <br/>) as data<br/></pre>",
        "picture": "img/projects/wasted.png", 
        "map": "tunisia.map-u3z7fdnm,mehdi118218.hjp3c1gc"
    },
    {   
    "_id": "11",
    "lang": "en", "learn":" Learn more",
        "title": "Visualizing the proportion of blank ballots cast",
        "excerpt":"Blank ballots are ballots cast by voters without a tick for a candidate, political party or coalition list.  In general, a blank ballot is cast by a voter who wishes to exercise his or her right to vote, but is dissatisfied with his or her candidate options or the electoral process.  In the 2011 National Constituent ...",
        "subtitle": "Ballots cast and political representation",
        "description": "Blank ballots are ballots cast by voters without a tick for a candidate, political party or coalition list.  In general, a blank ballot is cast by a voter who wishes to exercise his or her right to vote, but is dissatisfied with his or her candidate options or the electoral process.  In the 2011 National Constituent Assembly elections, nearly 100,000 voters cast blank ballots.  This visualization show the number of blank ballots cast per electoral district from the 2011 NCA elections",
        "about_data": "Two datasets power this map:<br/>- [full 2011 election results]() available as individual `.json` files, parsed and provided as a single district-level CSV. <br/>- geometry for the 27 districts derived from the [delegtion shapefiles](https://github.com/fwelections/tunisia-election-data/tree/master/shapes).",
        "methodology": "<h4>1. Import data to PostGIS</h4>To set up the a table with appropriate columns, run the following SQL:<br/><pre><br/>create table blank (<br/>cir_id int,<br/>circ_name text,<br/>total_votes numeric,<br/>votes_ennahdha numeric,<br/>votes_cpr numeric,<br/>votes_fdtl numeric,<br/>other_winning numeric,<br/>Wasted numeric,<br/>Blank_ballots numeric,<br/>cancelled_ballots numeric<br/>);<br/></pre><br/>Now run the following from your command line to populate the table: <br/><pre><br/>blank-votes.csv | psql -d tunisia -c \"COPY blank FROM STDIN WITH DELIMITER ',' CSV HEADER\"<br/></pre><h4>2. Dissolving Delegations into Districts</h4><p>*Note: If you have already performed this step for the Political parties map, you can skip to step 4.*<br/>Since this data has a district-level resolution, we need to create district polygons out of [delegation polygons that we already imported](https://github.com/fwelections/tunisia-election-data/tree/master/shapes).<br/>To do this you'll need to load the `filter_rings()` function explained in [this post](http://www.spatialdbadvisor.com/postgis_tips_tricks/92/filtering-rings-in-polygon-postgis). This  functions removes artifacts left by unioning each district's member delegations. Once you've loaded [the function](https://gist.github.com/ian29/5091516) into your database, run the following query.<br/><pre><br/>create table districts as (<br/>select<br/>circo_id,<br/>filter_rings(st_union(the_geom),2) as the_geom<br/>from delegations<br/>group by circo_id<br/>);<br/></pre><h4>4. Joining to geometry</h4><p>You should now be able to open the [Blank votes tilemill project](!SITE.GITHUB!/tree/gh-pages/map-src/blank)<br/>We're joining the tabular data to geometry in TileMill's PostGIS plugin. The query is here for your reference, but you should need to perform any further steps.</p> <br/><pre><br/>( select<br/>the_geom,<br/>cir_id,<br/>circ_name,<br/>blank_ballots,<br/>cancelled_ballots,<br/>wasted,<br/>map,<br/>total_votes,<br/>round((map / total_votes * 100)) as pct_n,<br/>cast(round((map / total_votes * 100)) as text)||'%' as pct_s,<br/>cast(round((map / total_votes * 100)) as text)||'%'||E' \n'||circ_name as display<br/>from districts a join blank b <br/>on circo_id = cir_id <br/>) as data<br/></pre> ",
        "picture": "img/projects/blanc.png", 
        "map": "tunisia.map-u3z7fdnm,mehdi118218.hifi40b0"
    },
    {   
    "_id": "12",
    "lang": "en", "learn":" Learn more",
        "title": "Visualizing the representation in the NCA (Turnout vs #Seats)",
        "excerpt":"Lorem ipsum kadharum ip lsoqd juie polirute sitopeste osis...",
        "subtitle": "Representation",
        "description": "Lorem ipsum kadharum ip lsoqd juie polirute sitopeste osis...",
        "about_data": "",
        "methodology": "",
        "picture": "img/projects/repr_turn.png", 
        "map": "tunisia.map-u3z7fdnm,mehdi118218.i6e99i2g"
    }
   
]
